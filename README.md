# Система учета пересечений объектов с железнодорожными путями

FastAPI приложение для учета и управления информацией о пересечениях различных объектов инфраструктуры с железнодорожными путями.

## Описание

Система предназначена для учета точек пересечения следующих типов объектов с ЖД путями:
- **Мосты** - различные типы мостов (железнодорожные, автомобильные, пешеходные)
- **Насыпи** - железнодорожные и автомобильные насыпи
- **ЛЭП** - линии электропередачи различного напряжения
- **Трубопроводы** - магистральные трубопроводы для транспортировки нефти и газа

Каждый объект хранится как точка пересечения с координатами и метаданными.

## Технологический стек

- **FastAPI** - веб-фреймворк для создания API
- **SQLAlchemy** - ORM для работы с базой данных
- **SQLite** - база данных
- **Pydantic** - валидация данных
- **Poetry** - управление зависимостями

## Установка и запуск

### Предварительные требования

- Python 3.8+
- Poetry

### Установка зависимостей

```bash
poetry install
```

### Запуск приложения

```bash
poetry run python app/run.py
```

Или через uvicorn напрямую:

```bash
poetry run uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

Приложение будет доступно по адресу: http://localhost:8000

## API Документация

После запуска приложения доступна интерактивная документация API:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## Эндпоинты API

### Мосты
- `GET /bridges/` - получить список всех мостов
- `POST /bridges/` - создать новый мост

### Насыпи
- `GET /embankments/` - получить список всех насыпей
- `POST /embankments/` - создать новую насыпь

### ЛЭП
- `GET /powerlines/` - получить список всех ЛЭП
- `POST /powerlines/` - создать новую ЛЭП

### Трубопроводы
- `GET /pipelines/` - получить список всех трубопроводов
- `POST /pipelines/` - создать новый трубопровод

### Системные
- `GET /health` - проверка состояния приложения

## Структура проекта

```
app/
├── core/           # Конфигурация
├── db/            # Настройки базы данных
├── models/        # SQLAlchemy модели
├── routers/       # API роутеры
├── schemas/       # Pydantic схемы
├── services/      # Бизнес-логика
├── main.py        # Главный файл приложения
└── run.py         # Точка входа
```

## Модели данных

### Мост (Bridge)
- `name` - название моста
- `owner` - владелец
- `year_commissioned` - год ввода в эксплуатацию
- `bridge_type` - тип моста (rail/road/pedestrian)
- `length_m` - длина в метрах
- `centroid_lat/lon` - координаты точки пересечения

### Насыпь (Embankment)
- `name` - название насыпи
- `owner` - владелец
- `year_commissioned` - год ввода в эксплуатацию
- `type` - тип насыпи (rail/road)
- `centroid_lat/lon` - координаты точки пересечения

### ЛЭП (PowerLine)
- `name` - название ЛЭП
- `owner` - владелец
- `year_commissioned` - год ввода в эксплуатацию
- `voltage_kv` - напряжение в киловольтах
- `centroid_lat/lon` - координаты точки пересечения

### Трубопровод (PipeLine)
- `name` - название трубопровода
- `owner` - владелец
- `year_commissioned` - год ввода в эксплуатацию
- `medium` - тип транспортируемого вещества (oil/gas)
- `diameter_mm` - диаметр в миллиметрах
- `centroid_lat/lon` - координаты точки пересечения

## Инициализация данных

При первом запуске приложения автоматически создаются тестовые данные с предопределенными координатами:
- 4 моста
- 6 насыпей
- 11 ЛЭП
- 4 трубопровода

Все координаты соответствуют реальным точкам в Самарской области.

## Разработка

### Добавление новых типов объектов

1. Создать модель в `app/models/`
2. Создать схемы в `app/schemas/`
3. Добавить роутер в `app/routers/`
4. Обновить мапперы в `app/services/mappers.py`
5. Добавить роутер в `app/main.py`

### Формат координат

Координаты хранятся в формате WGS84:
- Широта (lat): от 51.0 до 55.5 (Самарская область)
- Долгота (lon): от 47.0 до 52.0 (Самарская область)

## Лицензия

Проект создан для внутреннего использования РЖД.
